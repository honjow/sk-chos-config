#!/bin/bash

set -e

# cant run this script as root
if [ "$EUID" -eq 0 ]; then
    echo "Please run this script as a normal user, not root."
    exit 1
fi

pkgname=gamescope-session-git

temp_dir=$(mktemp -d)

mkdir -p $temp_dir/$pkgname
cd $temp_dir/$pkgname

curl -L "https://gitee.com/honjow/sk-chos-scripts/raw/master/aur-pkgs/${pkgname}/PKGBUILD" -o PKGBUILD
curl -L "https://gitee.com/honjow/sk-chos-scripts/raw/master/aur-pkgs/${pkgname}/gamescope-session.install" -o gamescope-session.install

makepkg -fCcs

sudo pacman -U --noconfirm *.pkg.tar.zst --overwrite "*" --needed